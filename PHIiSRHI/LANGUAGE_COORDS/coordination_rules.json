{
  "schema_version": "1.0",
  "ruleset_name": "Multi-Agent Coordination Rules",
  "version": "1.0.0",
  "last_updated": "2024-01-01T00:00:00Z",
  "turn_management": {
    "sequence": ["STRYK", "DC", "VSCC"],
    "turn_duration_ms": 1000,
    "max_idle_turns": 3,
    "auto_advance": true,
    "skip_inactive": true
  },
  "handoff_protocols": {
    "STRYK_to_DC": {
      "triggers": ["task_ready", "coordination_complete", "automation_required"],
      "conditions": ["dc_available", "no_pending_tasks"],
      "timeout_ms": 500,
      "retry_count": 3,
      "fallback": "emergency_mode"
    },
    "DC_to_VSCC": {
      "triggers": ["ui_complete", "data_extracted", "code_needed"],
      "conditions": ["vscode_active", "content_ready"],
      "timeout_ms": 500,
      "retry_count": 3,
      "fallback": "file_based_only"
    },
    "VSCC_to_STRYK": {
      "triggers": ["code_complete", "validation_needed", "analysis_ready"],
      "conditions": ["strategic_decision_needed"],
      "timeout_ms": 500,
      "retry_count": 3,
      "fallback": "auto_validate"
    },
    "any_to_any": {
      "triggers": ["error", "critical", "emergency"],
      "conditions": ["system_health_check"],
      "timeout_ms": 200,
      "retry_count": 5,
      "fallback": "broadcast_all"
    }
  },
  "priority_system": {
    "levels": {
      "1": {
        "name": "critical",
        "description": "System critical - immediate attention",
        "preemption": true,
        "escalation": "immediate"
      },
      "2": {
        "name": "high",
        "description": "High priority - next available turn",
        "preemption": false,
        "escalation": "3_turns"
      },
      "3": {
        "name": "normal",
        "description": "Standard priority - normal queue",
        "preemption": false,
        "escalation": "5_turns"
      },
      "4": {
        "name": "low",
        "description": "Low priority - background processing",
        "preemption": false,
        "escalation": "10_turns"
      }
    },
    "assignment_rules": {
      "critical": "assign_immediately",
      "high": "assign_next_turn",
      "normal": "queue_by_agent",
      "low": "background_queue"
    }
  },
  "deadlock_prevention": {
    "enabled": true,
    "detection_interval_turns": 2,
    "max_wait_time_ms": 2000,
    "resolution_strategies": [
      "timeout_recovery",
      "agent_reset",
      "task_requeue",
      "emergency_mode"
    ],
    "prevention_rules": {
      "circular_dependencies": "forbidden",
      "mutual_exclusion": "time_limited",
      "hold_and_wait": "minimize",
      "no_preemption": "exceptions_allowed"
    }
  },
  "error_handling": {
    "retry_policies": {
      "network_error": {
        "max_retries": 3,
        "backoff_strategy": "exponential",
        "base_delay_ms": 100,
        "max_delay_ms": 1000
      },
      "file_error": {
        "max_retries": 2,
        "backoff_strategy": "linear",
        "base_delay_ms": 50,
        "max_delay_ms": 200
      },
      "agent_error": {
        "max_retries": 1,
        "backoff_strategy": "immediate",
        "base_delay_ms": 0,
        "max_delay_ms": 0
      },
      "system_error": {
        "max_retries": 5,
        "backoff_strategy": "exponential",
        "base_delay_ms": 500,
        "max_delay_ms": 5000
      }
    },
    "escalation_rules": {
      "level_1": "retry_with_backoff",
      "level_2": "alternate_agent",
      "level_3": "emergency_mode",
      "level_4": "system_shutdown"
    }
  },
  "resource_management": {
    "memory_limits_mb": {
      "STRYK": 128,
      "DC": 256,
      "VSCC": 512
    },
    "cpu_limits_percent": {
      "STRYK": 25,
      "DC": 50,
      "VSCC": 75
    },
    "cleanup_rules": {
      "temp_files": "after_1_hour",
      "logs": "after_24_hours",
      "cache": "after_6_hours",
      "snapshots": "keep_last_10"
    }
  },
  "coordination_matrix": {
    "DC↔VSCC": {
      "protocol": "autohotkey_injection",
      "handoff_trigger": "code_ready",
      "timeout_ms": 500,
      "fallback": "file_based"
    },
    "DC↔Browser": {
      "protocol": "window_message",
      "handoff_trigger": "ui_ready",
      "timeout_ms": 500,
      "fallback": "console_injection"
    },
    "VSCC↔Browser": {
      "protocol": "file_based",
      "handoff_trigger": "content_ready",
      "timeout_ms": 500,
      "fallback": "direct_injection"
    },
    "STRYK↔Any": {
      "protocol": "powershell_alert",
      "handoff_trigger": "coordination_needed",
      "timeout_ms": 300,
      "fallback": "emergency_broadcast"
    }
  },
  "validation_rules": {
    "message_validation": {
      "required_fields": ["from", "to", "type", "timestamp"],
      "max_size_bytes": 1048576,
      "schema_validation": true
    },
    "task_validation": {
      "required_fields": ["task_id", "title", "priority", "assigned_agent"],
      "max_turns": 50,
      "dependency_check": true
    },
    "state_validation": {
      "session_id_required": true,
      "turn_counter_valid": true,
      "agent_states_consistent": true
    }
  },
  "performance_optimization": {
    "batch_processing": true,
    "parallel_operations": false,
    "caching_enabled": true,
    "compression_enabled": true,
    "prediction_enabled": false,
    "adaptive_timeout": true
  }
}