{
  "door_code": "S21DESERIALIZATION",
  "semantic_path": "SECURITY.VULNERABILITIES.INSECURE_DESERIALIZATION",
  "aliases": [
    "deserialization",
    "unsafe deserialization",
    "pickle attack",
    "object injection",
    "serialization vulnerability"
  ],
  "context_bundle": {
    "summary": "Insecure deserialization prevention: avoid deserializing untrusted data, use safe formats (JSON over pickle/serialize), implement integrity checks (HMAC signatures), use allowlists for allowed classes, prefer stateless authentication (JWT) over sessions.",
    "prerequisites": [
      "S03INPUT_VAL",
      "S12API_SECURITY"
    ],
    "related_doors": [
      "S08JWT",
      "S16INPUT_SANITIZATION",
      "S20CRYPTO_FAILURES"
    ],
    "onboarding": {
      "quick_start": "Deserialization defense: 1) Prefer JSON/Protocol Buffers over native serialization (pickle, Java serialize, PHP unserialize), 2) Sign serialized data with HMAC before deserializing, 3) Use allowlists for object types, 4) Run deserialization in sandboxed environments, 5) Validate data structure after deserializing.",
      "full_context_path": "/PhiDEX/MASTER_CODEX/06_SECURITY/OWASP_TOP_10_GUIDE.md",
      "common_patterns": [
        "Python: Avoid pickle.loads() on untrusted data, use json.loads() instead",
        "Java: Avoid ObjectInputStream with untrusted data, use JSON libraries (Jackson, Gson)",
        "PHP: Avoid unserialize() on user input, use json_decode()",
        "Node.js: Avoid eval() or Function() on serialized data, use JSON.parse()",
        "Integrity check: HMAC-SHA256(serialized_data, secret_key) before deserialize",
        "Allowlist: Check __class__ or type against approved types after deserialize"
      ],
      "known_errors": [
        {
          "error": "Python pickle remote code execution via crafted pickle data",
          "cause": "pickle.loads() can execute arbitrary code during deserialization",
          "solution": "Never pickle.loads() untrusted data. Use JSON or MessagePack instead.",
          "prevention": "Linter rules to flag pickle.loads(), code review for serialization",
          "example": "BAD: pickle.loads(user_cookie). GOOD: json.loads(user_cookie) + schema validation"
        },
        {
          "error": "Java deserialization gadget chain attack",
          "cause": "ObjectInputStream can trigger code execution via malicious serialized objects",
          "solution": "Avoid ObjectInputStream, use JSON. If required, implement SerialKiller or ValidatingObjectInputStream with allowlist.",
          "prevention": "Static analysis for ObjectInputStream usage, runtime monitoring",
          "related_door": "S12API_SECURITY"
        },
        {
          "error": "PHP unserialize() object injection leading to arbitrary file write",
          "cause": "unserialize() can instantiate arbitrary classes with attacker-controlled properties",
          "solution": "Use json_decode() instead. If unserialize required, check allowed_classes parameter (PHP 7+).",
          "prevention": "Disable unserialize() on user input via security policy",
          "example": "GOOD: unserialize($data, ['allowed_classes' => ['SafeClass']])"
        },
        {
          "error": "Session cookie tampering via unsigned serialization",
          "cause": "Session data serialized without cryptographic signature",
          "solution": "Sign session cookies with HMAC, verify signature before deserializing",
          "prevention": "Use framework session management (Express sessions, Flask sessions with secret key)",
          "related_door": "S08JWT"
        }
      ]
    },
    "resources": {
      "docs": [
        "/PhiDEX/MASTER_CODEX/06_SECURITY/OWASP_TOP_10_GUIDE.md",
        "/PhiDEX/MASTER_CODEX/06_SECURITY/SECURITY_HARDENING_GUIDE.md"
      ],
      "code": [],
      "tests": [],
      "errors": []
    },
    "metadata": {
      "last_updated": "2025-11-22T04:00:00Z",
      "confidence": 1.0,
      "usage_count": 0,
      "success_rate": 0.0,
      "tags": [
        "deserialization",
        "pickle",
        "serialization",
        "owasp",
        "object_injection",
        "rce"
      ],
      "category": "SECURITY",
      "subcategory": "VULNERABILITIES",
      "version": "1.0.0",
      "tested_on": [
        "Python",
        "Java",
        "PHP",
        "Node.js"
      ],
      "agent_affinity": [
        "VSCC",
        "DC",
        "WEBC"
      ],
      "size_bytes": 4330,
      "token_estimate": 1083.0
    }
  }
}
